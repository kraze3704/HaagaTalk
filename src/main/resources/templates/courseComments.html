<!DOCTYPE HTML>

<HTML xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<HEAD>
<title>HaagaTalk!</title>
<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css"
	th:href="@{css/bootstrap.min.css}" />
</HEAD>

<BODY>
	<div sec:authorize="isAuthenticated()">
		<form th:action="@{/logout}" method="POST">
			<span th:inline="text">Hi
				[[${#httpServletRequest.remoteUser}]]!</span> <input type="submit"
				value="log out" />
		</form>

		<a href="/admin">to ADMIN page</a>
	</div>
	
	<div sec:authorize="isAnonymous()">
		<a href="/login">to login page</a>
	</div>

	<a th:href="@{/}">Back</a>

	<div>
		<h1 th:text="${Course.courseName}">Course name</h1>

		<table>
			<tr>
				<th>username</th>
				<th>comment</th>
				<th sec:authorize="isAuthenticated()">Authenticated</th>
			</tr>
			<tr th:each="comment : ${Comments}">
				<td th:text="${comment.username}">username</td>
				<td th:text="${comment.comment}">comment</td>
				<td sec:authorize="isAuthenticated()">
					<a style="color: red; font-style: italic">edit(need user validation)</a>
					<a sec:authorize="hasAuthority('ADMIN')" th:href="@{/{courseId}/delete/{id}(courseId=${Course.id}, id=${comment.commentId})}">delete</a>
				</td>
			</tr>
		</table>
		
<!-- old comment	
<span th:text="|${comment.username}: ${comment.comment}|">username:comment</span>
<a>[ edit / delete / like ]</a>
-->
	</div>

	<div>
		<form name="commentForm" th:object="${COMMENT}" th:action="@{addComment}" action="#"
			method="POST">
			<input type="hidden" th:value="${Course.id}" name="courseId" />
			<input sec:authorize="isAuthenticated()" type="hidden" th:value="${#httpServletRequest.remoteUser}" name="username" />
			<input sec:authorize="!isAuthenticated()" type="hidden" th:value="anonymous" name="username" />
			<label for="comment">Comment</label>
			<input type="text" id="text" th:field="*{comment}" />
			<input type="submit" value="ENTER" />
		</form>
	</div>
</BODY>

</HTML>